<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memo@AG | PPD Alor Gajah</title>
    
    <!-- Favicon Rasmi -->
    <link rel="icon" href="icoppdag.png" type="image/png">
    
    <!-- Integrasi Fon Korporat (Inter) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- CSS Khusus (Telah diasingkan) -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Konfigurasi Tailwind untuk Fon Inter -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Supabase JS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="bg-slate-50 min-h-screen font-sans text-slate-800 antialiased selection:bg-indigo-100 selection:text-indigo-900">

    <div class="max-w-6xl mx-auto p-4 sm:p-8 my-4 sm:my-8 relative">
        
        <!-- Butang Akses Admin & Info (Top Right) -->
        <div class="absolute top-6 right-6 sm:top-10 sm:right-10 z-10 flex space-x-2 sm:space-x-4">
            <button id="btnTentang" onclick="switchTab('about')" class="text-xs font-bold text-slate-500 hover:text-indigo-600 transition-colors bg-white px-3 py-1.5 rounded-full shadow-sm border border-slate-200 flex items-center">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                <span class="hidden sm:inline">Tentang Sistem</span>
            </button>
            <button id="btnBukaLoginAdmin" class="text-xs font-bold text-slate-400 hover:text-indigo-600 transition-colors bg-white px-3 py-1.5 rounded-full shadow-sm border border-slate-200">
                Akses Pentadbir
            </button>
            <button id="btnLogKeluarAdmin" class="hidden text-xs font-bold text-red-500 hover:text-white hover:bg-red-50 transition-colors bg-white px-3 py-1.5 rounded-full shadow-sm border border-red-200">
                Log Keluar
            </button>
        </div>

        <div class="bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden">
            
            <!-- Header Korporat -->
            <div class="px-6 py-10 text-center border-b border-slate-100 bg-slate-50/50 relative">
                <img src="icoppdag.png" alt="Logo PPD Alor Gajah" class="h-28 mx-auto object-contain drop-shadow-sm mb-5">
                <h2 class="text-2xl sm:text-3xl font-extrabold text-slate-800 tracking-tight">Memo@AG</h2>
                <p class="text-slate-700 text-base sm:text-lg mt-3 font-semibold">Pejabat Pendidikan Daerah Alor Gajah.</p>
                <p class="text-slate-500 text-sm mt-1 max-w-2xl mx-auto font-medium">Platform pengurusan memo dan surat rasmi rentas sektor.</p>
            </div>

            <!-- SPA Tab Navigation (Hanya Untuk Pentadbir) -->
            <div class="flex flex-wrap justify-center bg-white px-2 sm:px-6 border-b border-slate-100">
                <button id="tabBtnAdminPanel" class="hidden tab-btn py-3 px-4 sm:px-6 text-sm font-bold border-b-2 border-transparent text-red-500 hover:text-red-700 focus:outline-none">
                    <span class="flex items-center">
                        <svg class="w-4 h-4 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                        Panel Pentadbir
                    </span>
                </button>
            </div>

            <!-- TAB 0: LAMAN UTAMA (LANDING PAGE) -->
            <div id="tabUtama" class="block bg-slate-50 p-6 sm:p-10 min-h-[500px]">
                <div class="max-w-4xl mx-auto">
                    <div class="text-center mb-10">
                        <h3 class="text-2xl font-bold text-slate-800">Selamat Datang ke Sistem Memo@AG</h3>
                        <p class="text-slate-500 mt-2">Sila pilih modul operasi yang ingin diakses di bawah.</p>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Menu 1 -->
                        <div onclick="switchTab('daftar')" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 hover:shadow-lg hover:border-indigo-400 hover:-translate-y-1 transition-all cursor-pointer group text-center flex flex-col items-center">
                            <div class="w-16 h-16 bg-indigo-100 text-indigo-600 rounded-full flex items-center justify-center mb-6 group-hover:bg-indigo-600 group-hover:text-white transition-colors">
                                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                            </div>
                            <h4 class="text-lg font-bold text-slate-700 group-hover:text-indigo-700 transition-colors">Daftar Surat / Memo</h4>
                            <p class="text-sm text-slate-500 mt-2 leading-relaxed">Muat naik salinan dokumen dan daftar rekod surat menyurat rentas sektor.</p>
                        </div>

                        <!-- Menu 2 -->
                        <div onclick="switchTab('analisis')" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 hover:shadow-lg hover:border-emerald-400 hover:-translate-y-1 transition-all cursor-pointer group text-center flex flex-col items-center">
                            <div class="w-16 h-16 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center mb-6 group-hover:bg-emerald-600 group-hover:text-white transition-colors">
                                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                            </div>
                            <h4 class="text-lg font-bold text-slate-700 group-hover:text-emerald-700 transition-colors">Semakan & Analisis</h4>
                            <p class="text-sm text-slate-500 mt-2 leading-relaxed">Akses pangkalan data untuk analisis, carian, dan jejak dokumen memo dalam sistem.</p>
                        </div>

                        <!-- Menu 3 -->
                        <div onclick="switchTab('kalendar')" class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200 hover:shadow-lg hover:border-amber-400 hover:-translate-y-1 transition-all cursor-pointer group text-center flex flex-col items-center">
                            <div class="w-16 h-16 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center mb-6 group-hover:bg-amber-500 group-hover:text-white transition-colors">
                                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            </div>
                            <h4 class="text-lg font-bold text-slate-700 group-hover:text-amber-700 transition-colors">Kalendar Pengesahan</h4>
                            <p class="text-sm text-slate-500 mt-2 leading-relaxed">Lihat jadual pengurusan surat yang diintegrasi terus ke kalendar rasmi untuk tujuan RSVP penerima.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 1: PENDAFTARAN MEMO -->
            <div id="tabDaftar" class="hidden">
                <form id="mainForm" class="p-6 sm:p-10 bg-slate-50">
                    
                    <!-- Butang Navigasi Kembali -->
                    <div class="mb-6">
                        <button type="button" onclick="switchTab('utama')" class="group flex items-center text-sm font-semibold text-slate-500 hover:text-indigo-600 transition-colors bg-white border border-slate-200 hover:border-indigo-300 rounded-full px-4 py-2 shadow-sm w-fit">
                            <svg class="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                            Kembali ke Menu Utama
                        </button>
                    </div>

                    <div id="messageBox" class="hidden mb-8 p-4 rounded-lg font-medium text-sm border"></div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 bg-white p-8 rounded-xl shadow-sm border border-slate-200">
                        <!-- FASA 0: MUAT NAIK FAIL -->
                        <div class="col-span-1 md:col-span-2 p-6 bg-indigo-50/50 rounded-xl border-2 border-dashed border-indigo-200 mb-2 transition-all hover:border-indigo-400">
                            <label for="salinanSurat" class="block text-sm font-bold text-indigo-700 uppercase tracking-wider mb-2">Langkah 1: Muat Naik Salinan Dokumen <span class="text-red-500">*</span></label>
                            <p class="text-xs text-slate-500 mb-4">Sila muat naik dokumen (PDF/Imej) untuk mengaktifkan dan membuka kunci borang maklumat. Masa rekod akan ditetapkan secara automatik.</p>
                            
                            <div id="uploadContainer" class="relative">
                                <input id="salinanSurat" type="file" accept=".pdf, image/*" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-6 file:rounded-lg file:border-0 file:text-sm file:font-bold file:bg-indigo-600 file:text-white hover:file:bg-indigo-700 cursor-pointer shadow-sm transition-all">
                                
                                <div id="uploadStatus" class="mt-4 hidden items-center space-x-3 bg-white p-3 rounded-lg border border-emerald-200 shadow-sm">
                                    <div id="uploadLoader" class="loader"></div>
                                    <span id="uploadText" class="text-sm font-medium text-slate-600">Sedang menyediakan fail...</span>
                                    <a id="fileLink" href="#" target="_blank" class="hidden text-sm font-bold text-emerald-600 underline truncate flex-1 hover:text-emerald-800">Lihat Fail Drive</a>
                                    <button type="button" id="resetFileBtn" class="hidden text-xs text-red-500 font-bold hover:bg-red-50 px-3 py-1.5 rounded border border-red-200 transition-colors">Padam / Tukar</button>
                                </div>
                            </div>
                        </div>

                        <!-- FASA 1 - 4: BORANG MAKLUMAT -->
                        <div id="borangUtama" class="col-span-1 md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6 hidden opacity-0 transition-opacity duration-500">
                            
                            <div class="col-span-1 md:col-span-2 border-b border-slate-100 pb-2 mt-4">
                                <h3 class="text-lg font-bold text-slate-700">Langkah 2: Maklumat Pendaftaran</h3>
                                <p class="text-xs text-slate-500 mt-1">Sektor yang dipilih di bawah akan dijadikan rujukan utama surat menyurat.</p>
                            </div>

                            <div class="col-span-1">
                                <label for="sektor" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Sektor Utama <span class="text-red-500">*</span></label>
                                <select id="sektor" name="sektor" required class="w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-slate-100">
                                    <option value="">Sila pilih sektor...</option>
                                </select>
                            </div>

                            <div class="col-span-1">
                                <label for="unit" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Unit <span class="text-red-500">*</span></label>
                                <select id="unit" name="unit" required class="w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:bg-white focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 disabled:bg-slate-100" disabled>
                                    <option value="">Pilih Sektor Dahulu</option>
                                </select>
                            </div>

                            <div class="col-span-1 md:col-span-2">
                                <label class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Penerima Terpilih (Rentas Sektor) <span class="text-red-500">*</span></label>
                                <div id="selectedTagsContainer" class="flex flex-wrap gap-2 mb-3 min-h-[44px] p-3 bg-white border border-slate-300 rounded-lg shadow-sm transition-colors focus-within:ring-2 focus-within:ring-indigo-500">
                                    <span class="text-sm text-slate-400 italic">Belum ada penerima dipilih...</span>
                                </div>
                                <div id="namaContainer" class="w-full px-4 py-3 border border-slate-300 rounded-lg bg-slate-50 h-52 overflow-y-auto custom-scrollbar shadow-inner relative">
                                    <div class="text-slate-400 italic text-sm mt-1">Sila Pilih Unit Dahulu</div>
                                </div>
                            </div>

                            <div class="col-span-1 md:col-span-2">
                                <label for="email" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Alamat Emel Penerima (Auto) <span class="text-red-500">*</span></label>
                                <textarea id="email" name="email" required readonly rows="2" class="w-full px-4 py-3 border border-slate-300 rounded-lg bg-slate-100 cursor-not-allowed text-slate-500 custom-scrollbar focus:outline-none"></textarea>
                            </div>

                            <!-- MEDAN BAHARU -->
                            <div class="col-span-1 md:col-span-2 border-t border-slate-100 pt-6 mt-2">
                                <h3 class="text-md font-bold text-slate-700 mb-4">Langkah 3: Butiran Surat & Rekod Masa</h3>
                            </div>

                            <div class="col-span-1">
                                <label for="noRujukan" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">No. Rujukan Surat <span class="text-red-500">*</span></label>
                                <input type="text" id="noRujukan" name="noRujukan" required pattern="[A-Za-z0-9/\-_\s\.]+" title="Sila masukkan aksara abjad angka (alphanumeric), titik, palang, atau sengkang sahaja" class="w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:bg-white focus:ring-2 focus:ring-indigo-500 focus:outline-none uppercase-input placeholder-slate-400 font-medium" placeholder="CTH: PPDAG.100-1/1/1">
                            </div>

                            <div class="col-span-1 md:col-span-2">
                                <label for="tajukProgram" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Perkara / Tajuk Surat (Huruf Besar) <span class="text-red-500">*</span></label>
                                <input type="text" id="tajukProgram" name="tajukProgram" required class="w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:bg-white focus:ring-2 focus:ring-indigo-500 focus:outline-none uppercase-input placeholder-slate-400 font-medium" placeholder="Cth: SURAT ARAHAN PENGURUSAN DOKUMEN 2024">
                            </div>

                            <div class="col-span-1">
                                <label for="tarikhTerima" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Tarikh Terima Surat <span class="text-red-500">*</span></label>
                                <input type="date" id="tarikhTerima" name="tarikhTerima" required class="w-full px-4 py-3 bg-slate-50 border border-slate-300 rounded-lg focus:bg-white focus:ring-2 focus:ring-indigo-500 focus:outline-none">
                            </div>

                            <div class="col-span-1">
                                <label for="masaRekod" class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-2">Masa Mula Tindakan (Auto) <span class="text-red-500">*</span></label>
                                <input type="time" id="masaRekod" name="masaRekod" required readonly class="w-full px-4 py-3 border border-slate-300 rounded-lg bg-slate-100 cursor-not-allowed text-slate-500 focus:outline-none">
                                <p class="text-xs text-indigo-500 mt-1 font-semibold">* Jemputan kalendar akan dijana secara automatik</p>
                            </div>

                            <div class="col-span-1 md:col-span-2 mt-6 flex justify-end border-t border-slate-100 pt-6">
                                <button type="submit" id="submitBtn" class="bg-gradient-to-r from-indigo-600 to-blue-600 hover:from-indigo-700 hover:to-blue-700 text-white font-bold py-4 px-10 rounded-xl shadow-md hover:shadow-xl transition-all duration-200 flex items-center transform hover:-translate-y-0.5">
                                    <span id="btnText" class="flex items-center text-sm tracking-widest uppercase">Simpan & Hantar Rekod</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- TAB 2: ANALISIS & SEMAKAN -->
            <div id="tabAnalisis" class="hidden bg-slate-50 p-6 sm:p-10 min-h-[500px]">
                
                <!-- Butang Navigasi Kembali -->
                <div class="mb-6">
                    <button type="button" onclick="switchTab('utama')" class="group flex items-center text-sm font-semibold text-slate-500 hover:text-indigo-600 transition-colors bg-white border border-slate-200 hover:border-indigo-300 rounded-full px-4 py-2 shadow-sm w-fit">
                        <svg class="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                        Kembali ke Menu Utama
                    </button>
                </div>

                <!-- KPI Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex items-center">
                        <div class="p-3 rounded-full bg-indigo-100 text-indigo-600 mr-4">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        </div>
                        <div>
                            <p class="text-sm text-slate-500 font-bold uppercase tracking-wider">Jumlah Surat</p>
                            <p id="kpiTotal" class="text-3xl font-extrabold text-slate-800">0</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex items-center">
                        <div class="p-3 rounded-full bg-emerald-100 text-emerald-600 mr-4">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                        </div>
                        <div>
                            <p class="text-sm text-slate-500 font-bold uppercase tracking-wider">Tindakan Hari Ini</p>
                            <p id="kpiToday" class="text-3xl font-extrabold text-slate-800">0</p>
                        </div>
                    </div>
                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 flex items-center">
                        <div class="p-3 rounded-full bg-blue-100 text-blue-600 mr-4">
                            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>
                        </div>
                        <div class="w-full">
                            <p class="text-sm text-slate-500 font-bold uppercase tracking-wider">Sektor Teraktif</p>
                            <p id="kpiTopSektor" class="text-lg font-extrabold text-slate-800 break-words">-</p>
                        </div>
                    </div>
                </div>

                <!-- Carian dan Jadual -->
                <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="p-4 border-b border-slate-200 bg-slate-50 flex flex-col gap-4">
                        <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
                            <h3 class="text-lg font-bold text-slate-700 w-full sm:w-auto">Senarai Surat Masuk</h3>
                            <div class="relative w-full sm:w-72">
                                <input type="text" id="searchInput" placeholder="Cari Rujukan / Perkara / Penerima..." class="w-full pl-10 pr-4 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm">
                                <svg class="w-5 h-5 text-slate-400 absolute left-3 top-2.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                            </div>
                        </div>

                        <!-- MODUL TAPISAN BAHARU -->
                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mt-2">
                            <select id="filterSektor" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm text-slate-600 bg-white">
                                <option value="">Semua Sektor</option>
                            </select>
                            <select id="filterUnit" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm text-slate-600 bg-white">
                                <option value="">Semua Unit</option>
                            </select>
                            <select id="filterBulan" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm text-slate-600 bg-white">
                                <option value="">Semua Bulan</option>
                            </select>
                            <select id="filterTarikh" class="w-full px-3 py-2 border border-slate-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 text-sm text-slate-600 bg-white">
                                <option value="">Semua Tarikh</option>
                            </select>
                            <button id="btnResetFilter" class="w-full px-3 py-2 bg-slate-200 hover:bg-slate-300 text-slate-700 font-semibold rounded-lg transition-colors text-sm flex items-center justify-center">
                                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                                Set Semula
                            </button>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-slate-100 text-slate-600 text-xs uppercase tracking-wider font-bold">
                                    <th class="p-4 border-b border-slate-200">Tarikh & Masa</th>
                                    <th class="p-4 border-b border-slate-200">Sektor / Unit</th>
                                    <th class="p-4 border-b border-slate-200">Perkara & Rujukan</th>
                                    <th class="p-4 border-b border-slate-200">Penerima</th>
                                    <th class="p-4 border-b border-slate-200 text-center">Tindakan</th>
                                </tr>
                            </thead>
                            <tbody id="tableBody" class="text-sm divide-y divide-slate-100">
                                <tr>
                                    <td colspan="5" class="p-8 text-center text-slate-400">
                                        <div class="loader mr-2 border-slate-300 border-top-slate-500"></div> Memuatkan data pelayan...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- TAB 3: KALENDAR PROGRAM -->
            <div id="tabKalendar" class="hidden bg-slate-50 p-6 sm:p-10 min-h-[500px]">
                
                <!-- Butang Navigasi Kembali -->
                <div class="mb-6">
                    <button type="button" onclick="switchTab('utama')" class="group flex items-center text-sm font-semibold text-slate-500 hover:text-indigo-600 transition-colors bg-white border border-slate-200 hover:border-indigo-300 rounded-full px-4 py-2 shadow-sm w-fit">
                        <svg class="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                        Kembali ke Menu Utama
                    </button>
                </div>

                <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-4 md:p-6 h-full flex flex-col">
                    <div class="mb-4 flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-bold text-slate-700">Kalendar Pengesahan Tindakan</h3>
                            <p class="text-sm text-slate-500 mt-1">Paparan kalendar rasmi semua surat yang telah direkodkan ke dalam sistem berserta notifikasi RSVP.</p>
                        </div>
                    </div>
                    
                    <div class="w-full flex-1 min-h-[500px] bg-slate-100 rounded-lg overflow-hidden border border-slate-200">
                        <iframe 
                            id="calendarFrame"
                            src="https://calendar.google.com/calendar/embed?src=c_f0a44fa5b697d8af04d01f229b28ecb766cb9dd1f5d0c9d287aec3f164524888%40group.calendar.google.com&ctz=Asia%2FKuala_Lumpur" 
                            class="w-full h-[500px] sm:h-[600px] md:h-[700px]" 
                            style="border: 0" 
                            frameborder="0" 
                            scrolling="no">
                        </iframe>
                    </div>
                </div>
            </div>

            <!-- TAB 4: PANEL PENTADBIR -->
            <div id="tabAdmin" class="hidden bg-slate-50 p-6 sm:p-10 min-h-[500px]">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">Papan Pemuka Pentadbir</h2>
                    <p class="text-sm text-slate-500">Uruskan rekod memo, pangkalan data pegawai, dan akses sistem.</p>
                </div>

                <!-- Sub-navigasi Admin -->
                <div class="flex space-x-2 mb-6 border-b border-slate-200 pb-2 overflow-x-auto custom-scrollbar">
                    <button id="subTabBtnMemo" class="admin-sub-tab px-4 py-2 text-sm font-bold bg-indigo-100 text-indigo-700 rounded-lg">Urus Memo & Kalendar</button>
                    <button id="subTabBtnPegawai" class="admin-sub-tab px-4 py-2 text-sm font-bold text-slate-600 hover:bg-slate-200 rounded-lg transition-colors">Urus Pegawai</button>
                    <button id="subTabBtnSistem" class="admin-sub-tab px-4 py-2 text-sm font-bold text-slate-600 hover:bg-slate-200 rounded-lg transition-colors">Akses Sistem</button>
                </div>

                <!-- Seksyen: URUS MEMO -->
                <div id="adminSectionMemo" class="admin-section block bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="p-4 border-b border-slate-200 flex flex-wrap justify-between items-center bg-slate-50 gap-3">
                        <h3 class="font-bold text-slate-700">Pangkalan Data Surat</h3>
                        <div class="flex space-x-2 w-full sm:w-auto overflow-x-auto pb-1 sm:pb-0 custom-scrollbar">
                            <input type="text" id="adminSearchMemo" placeholder="Cari Rujukan/Perkara..." class="flex-1 min-w-[150px] px-3 py-1.5 border border-slate-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500">
                            <button id="btnPukalSegerak" class="bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-1.5 rounded text-xs font-bold transition-colors shadow-sm whitespace-nowrap flex items-center">
                                <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                                Segerak Kalendar
                            </button>
                            <button id="btnPukalPadam" class="bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded text-xs font-bold transition-colors shadow-sm whitespace-nowrap flex items-center">
                                <svg class="w-3.5 h-3.5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                                Padam Kalendar
                            </button>
                        </div>
                    </div>
                    
                    <!-- Progress Bar Modul Pukal -->
                    <div id="adminBatchProgressContainer" class="hidden bg-indigo-50 p-3 border-b border-indigo-100 flex items-center justify-between">
                        <div class="flex items-center space-x-3 w-full">
                            <div class="loader border-indigo-300 border-top-indigo-600 w-4 h-4"></div>
                            <div class="flex-1">
                                <div class="flex justify-between text-xs font-bold text-indigo-800 mb-1">
                                    <span id="batchStatusText">Memproses 0/0 rekod...</span>
                                    <span id="batchPercentage">0%</span>
                                </div>
                                <div class="w-full bg-indigo-200 rounded-full h-1.5">
                                    <div id="batchProgressBar" class="bg-indigo-600 h-1.5 rounded-full transition-all duration-300" style="width: 0%"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead class="bg-slate-100 text-slate-600 text-xs uppercase tracking-wider font-bold">
                                <tr>
                                    <th class="p-3 border-b cursor-pointer hover:bg-slate-200 transition-colors" onclick="handleSort('memo', 'id')">
                                        <div class="flex items-center space-x-1">
                                            <span>ID</span>
                                            <span id="sort-memo-id" class="w-4 h-4 text-slate-400"></span>
                                        </div>
                                    </th>
                                    <th class="p-3 border-b cursor-pointer hover:bg-slate-200 transition-colors" onclick="handleSort('memo', 'no_rujukan')">
                                        <div class="flex items-center space-x-1">
                                            <span>No. Rujukan & Perkara</span>
                                            <span id="sort-memo-no_rujukan" class="w-4 h-4 text-slate-400"></span>
                                        </div>
                                    </th>
                                    <th class="p-3 border-b cursor-pointer hover:bg-slate-200 transition-colors" onclick="handleSort('memo', 'tarikh_terima')">
                                        <div class="flex items-center space-x-1">
                                            <span>Tarikh Terima & Masa</span>
                                            <span id="sort-memo-tarikh_terima" class="w-4 h-4 text-slate-400"></span>
                                        </div>
                                    </th>
                                    <th class="p-3 border-b text-center">Tindakan Kalendar</th>
                                    <th class="p-3 border-b text-center">Tindakan Data</th>
                                </tr>
                            </thead>
                            <tbody id="adminTableMemoBody" class="text-sm divide-y divide-slate-100">
                                <tr><td colspan="5" class="p-4 text-center text-slate-500">Memuatkan data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Seksyen: URUS PEGAWAI -->
                <div id="adminSectionPegawai" class="admin-section hidden bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="p-4 border-b border-slate-200 flex justify-between items-center bg-slate-50">
                        <h3 class="font-bold text-slate-700">Pangkalan Data Pegawai</h3>
                        <div class="flex space-x-2">
                            <input type="text" id="adminSearchPegawai" placeholder="Cari Pegawai..." class="w-64 px-3 py-1.5 border border-slate-300 rounded text-sm focus:outline-none focus:ring-1 focus:ring-indigo-500">
                            <button id="btnTambahPegawai" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-1.5 rounded text-sm font-bold transition-colors">Tambah Pegawai</button>
                        </div>
                    </div>
                    <div class="overflow-x-auto h-[400px] overflow-y-auto custom-scrollbar">
                        <table class="w-full text-left border-collapse relative">
                            <thead class="bg-slate-100 text-slate-600 text-xs uppercase tracking-wider font-bold sticky top-0 shadow-sm z-10">
                                <tr>
                                    <th class="p-3 border-b cursor-pointer hover:bg-slate-200 transition-colors" onclick="handleSort('pegawai', 'nama')">
                                        <div class="flex items-center space-x-1">
                                            <span>Nama Pegawai</span>
                                            <span id="sort-pegawai-nama" class="w-4 h-4 text-slate-400"></span>
                                        </div>
                                    </th>
                                    <th class="p-3 border-b cursor-pointer hover:bg-slate-200 transition-colors" onclick="handleSort('pegawai', 'sektor')">
                                        <div class="flex items-center space-x-1">
                                            <span>Sektor & Unit</span>
                                            <span id="sort-pegawai-sektor" class="w-4 h-4 text-slate-400"></span>
                                        </div>
                                    </th>
                                    <th class="p-3 border-b cursor-pointer hover:bg-slate-200 transition-colors" onclick="handleSort('pegawai', 'emel_rasmi')">
                                        <div class="flex items-center space-x-1">
                                            <span>Emel Rasmi</span>
                                            <span id="sort-pegawai-emel_rasmi" class="w-4 h-4 text-slate-400"></span>
                                        </div>
                                    </th>
                                    <th class="p-3 border-b text-center">Tindakan</th>
                                </tr>
                            </thead>
                            <tbody id="adminTablePegawaiBody" class="text-sm divide-y divide-slate-100">
                                <tr><td colspan="4" class="p-4 text-center text-slate-500">Memuatkan data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Seksyen: AKSES SISTEM -->
                <div id="adminSectionSistem" class="admin-section hidden bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                    <div class="p-4 border-b border-slate-200 flex justify-between items-center bg-slate-50">
                        <h3 class="font-bold text-slate-700">Pengurusan Akses Pentadbir</h3>
                        <button id="btnTambahAdmin" class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-1.5 rounded text-sm font-bold transition-colors">Tambah Admin</button>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead class="bg-slate-100 text-slate-600 text-xs uppercase tracking-wider font-bold">
                                <tr>
                                    <th class="p-3 border-b">ID Pentadbir</th>
                                    <th class="p-3 border-b">Alamat Emel</th>
                                    <th class="p-3 border-b">Peranan</th>
                                    <th class="p-3 border-b text-center">Tindakan</th>
                                </tr>
                            </thead>
                            <tbody id="adminTableSistemBody" class="text-sm divide-y divide-slate-100">
                                <tr><td colspan="4" class="p-4 text-center text-slate-500">Memuatkan data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- TAB 5: TENTANG SISTEM -->
            <div id="tabAbout" class="hidden bg-slate-50 p-6 sm:p-10 min-h-[500px]">
                
                <!-- Butang Navigasi Kembali -->
                <div class="mb-6">
                    <button type="button" onclick="switchTab('utama')" class="group flex items-center text-sm font-semibold text-slate-500 hover:text-indigo-600 transition-colors bg-white border border-slate-200 hover:border-indigo-300 rounded-full px-4 py-2 shadow-sm w-fit">
                        <svg class="w-4 h-4 mr-2 group-hover:-translate-x-1 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                        Kembali ke Menu Utama
                    </button>
                </div>

                <div class="max-w-4xl mx-auto space-y-8">
                    <!-- Header -->
                    <div class="text-center mb-10">
                        <h2 class="text-3xl font-bold text-slate-800 tracking-tight">Mengenai Sistem Memo@AG</h2>
                        <p class="text-slate-500 mt-3 max-w-2xl mx-auto text-sm sm:text-base">Platform berpusat pengurusan memo, penyelarasan surat rasmi, dan pengesahan maklum balas merentas sektor di Pejabat Pendidikan Daerah (PPD) Alor Gajah.</p>
                    </div>

                    <!-- Objektif & Latar Belakang -->
                    <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                        <h3 class="text-xl font-bold text-indigo-700 mb-4 flex items-center">
                            <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>
                            Objektif & Latar Belakang
                        </h3>
                        <p class="text-slate-600 leading-relaxed text-sm sm:text-base">
                            Sistem ini dibangunkan dengan seni bina berskala <em>Single Page Application</em> (SPA) khusus untuk menyelesaikan isu pemantauan tempoh tindakan surat rasmi. Sistem ini disokong oleh pangkalan data masa nyata dan dilengkapi dengan automasi Google Workspace (Google Drive, Calendar, dan Gmail) bagi memastikan semua surat diminit dan disahkan penerimaannya dengan segera.
                        </p>
                    </div>

                    <!-- Panduan Ringkas Grid -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <!-- Card 1 -->
                        <div class="bg-white p-6 rounded-xl border border-slate-200 hover:border-indigo-300 transition-colors shadow-sm">
                            <div class="w-10 h-10 bg-indigo-100 text-indigo-600 rounded-lg flex items-center justify-center mb-4">
                                <span class="font-bold">1</span>
                            </div>
                            <h4 class="font-bold text-slate-800 mb-2">Pendaftaran Surat</h4>
                            <p class="text-xs text-slate-500 leading-relaxed">Muat naik salinan dokumen untuk merekodkan masa permulaan. Lengkapkan maklumat penerima rentas sektor dan no rujukan. Sistem akan mengedarkan notifikasi emel secara automatik.</p>
                        </div>
                        <!-- Card 2 -->
                        <div class="bg-white p-6 rounded-xl border border-slate-200 hover:border-emerald-300 transition-colors shadow-sm">
                            <div class="w-10 h-10 bg-emerald-100 text-emerald-600 rounded-lg flex items-center justify-center mb-4">
                                <span class="font-bold">2</span>
                            </div>
                            <h4 class="font-bold text-slate-800 mb-2">Semakan & Analisis</h4>
                            <p class="text-xs text-slate-500 leading-relaxed">Pangkalan data terbuka membolehkan anda mencari rekod surat berdasarkan kata kunci, serta menapis carian mengikut sektor dan tarikh. Salinan asal sedia untuk dimuat turun.</p>
                        </div>
                        <!-- Card 3 -->
                        <div class="bg-white p-6 rounded-xl border border-slate-200 hover:border-amber-300 transition-colors shadow-sm">
                            <div class="w-10 h-10 bg-amber-100 text-amber-600 rounded-lg flex items-center justify-center mb-4">
                                <span class="font-bold">3</span>
                            </div>
                            <h4 class="font-bold text-slate-800 mb-2">RSVP & Kalendar</h4>
                            <p class="text-xs text-slate-500 leading-relaxed">Pendaftaran surat akan dihantar ke kalendar penerima secara automatik untuk pengesahan (RSVP). Pentadbir mempunyai kuasa penuh melalui panel Admin.</p>
                        </div>
                    </div>

                    <!-- Sokongan & Pembangun -->
                    <div class="bg-gradient-to-r from-slate-800 to-slate-900 p-8 rounded-2xl shadow-md text-center">
                        <h3 class="text-lg font-bold text-white mb-2">Sokongan & Bantuan Teknikal</h3>
                        <p class="text-slate-300 text-sm mb-6">Untuk sebarang pertanyaan, ralat sistem, atau bantuan lanjut, sila hubungi pentadbir sistem di bahagian USTP PPD Alor Gajah.</p>
                        <div class="inline-flex items-center justify-center bg-white/10 px-6 py-3 rounded-full border border-white/20">
                            <svg class="w-5 h-5 text-indigo-400 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path></svg>
                            <span class="text-white font-medium text-sm">Dibangunkan oleh <span class="font-bold text-indigo-300">Sektor Pengurusan (USTP) PPD Alor Gajah</span></span>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        
        <!-- Footer Korporat -->
        <div class="text-center mt-6 mb-8">
            <p class="text-xs font-medium text-slate-400">Hakcipta terpelihara USTP &copy; Pejabat Pendidikan Daerah Alor Gajah <span id="currentYear"></span>.</p>
        </div>
    </div>

    <!-- ================= MODAL COMPONENTS ================= -->

    <!-- Modal Log Masuk Admin -->
    <div id="modalLoginAdmin" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden transform transition-all">
            <div class="bg-indigo-600 p-6 text-center">
                <h3 class="text-xl font-bold text-white">Log Masuk Pentadbir</h3>
                <p class="text-indigo-100 text-sm mt-1">Akses terhad untuk penyelenggaraan sistem.</p>
            </div>
            <form id="formLoginAdmin" class="p-6 space-y-4">
                <div id="loginAdminError" class="hidden text-xs text-red-600 bg-red-50 p-3 rounded-lg border border-red-200 text-center font-bold"></div>
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-1">Alamat Emel</label>
                    <input type="email" id="loginAdminEmail" required class="w-full px-4 py-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 focus:outline-none text-sm">
                </div>
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase tracking-wider mb-1">Kata Laluan</label>
                    <input type="password" id="loginAdminPassword" required class="w-full px-4 py-2 border border-slate-300 rounded focus:ring-2 focus:ring-indigo-500 focus:outline-none text-sm">
                </div>
                <div class="pt-4 flex space-x-3">
                    <button type="button" id="btnBatalLogin" class="flex-1 px-4 py-2 bg-slate-100 text-slate-600 font-bold rounded hover:bg-slate-200 transition-colors">Batal</button>
                    <button type="submit" id="btnSubmitLogin" class="flex-1 px-4 py-2 bg-indigo-600 text-white font-bold rounded hover:bg-indigo-700 transition-colors flex justify-center items-center">Log Masuk</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Edit/Tambah Pegawai -->
    <div id="modalPegawai" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden">
            <div class="bg-slate-50 p-4 border-b border-slate-200 flex justify-between items-center">
                <h3 id="modalPegawaiTitle" class="text-lg font-bold text-slate-700">Tambah Pegawai Baharu</h3>
                <button type="button" class="btnTutupModal text-slate-400 hover:text-red-500 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <form id="formPegawai" class="p-6 space-y-4">
                <input type="hidden" id="pegawaiId">
                
                <!-- NAMA PENUH -->
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 tracking-wider">Nama Penuh <span class="text-red-500">*</span></label>
                    <input type="text" id="pegawaiNama" required class="w-full px-3 py-2 border border-slate-300 rounded uppercase-input text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none font-semibold" placeholder="CTH: AHMAD BIN ABU">
                </div>
                
                <!-- SEKTOR -->
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 tracking-wider">Sektor <span class="text-red-500">*</span></label>
                    <select id="pegawaiSektorSelect" class="w-full px-3 py-2 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none mb-2">
                        <option value="">-- PILIH SEKTOR --</option>
                        <option value="MANUAL">++ TAMBAH SEKTOR BAHARU ++</option>
                    </select>
                    <input type="text" id="pegawaiSektorManual" class="hidden w-full px-3 py-2 border border-slate-400 rounded text-sm uppercase-input bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-600" placeholder="MASUKKAN SEKTOR BARU (CTH: 01 SEKTOR PENGURUSAN)">
                </div>

                <!-- UNIT -->
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 tracking-wider">Unit <span class="text-red-500">*</span></label>
                    <select id="pegawaiUnitSelect" class="w-full px-3 py-2 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none mb-2">
                        <option value="">-- PILIH UNIT --</option>
                        <option value="MANUAL">++ TAMBAH UNIT BAHARU ++</option>
                    </select>
                    <input type="text" id="pegawaiUnitManual" class="hidden w-full px-3 py-2 border border-slate-400 rounded text-sm uppercase-input bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-indigo-600" placeholder="MASUKKAN UNIT BARU">
                </div>

                <!-- EMEL -->
                <div>
                    <label class="block text-xs font-bold text-slate-500 uppercase mb-1 tracking-wider">Emel Rasmi <span class="text-red-500">*</span></label>
                    <input type="email" id="pegawaiEmel" required class="w-full px-3 py-2 border border-slate-300 rounded text-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none" placeholder="cth@moe.gov.my">
                </div>

                <div class="pt-4 flex justify-end space-x-3 border-t border-slate-100">
                    <button type="button" class="btnTutupModal px-4 py-2 bg-slate-100 text-slate-600 font-bold rounded text-sm hover:bg-slate-200 transition-colors">Batal</button>
                    <button type="submit" id="btnSimpanPegawai" class="px-6 py-2 bg-indigo-600 text-white font-bold rounded text-sm hover:bg-indigo-700 flex items-center shadow-md transition-all">Simpan Data</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Edit Memo -->
    <div id="modalMemo" class="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg overflow-hidden">
            <div class="bg-slate-50 p-4 border-b border-slate-200 flex justify-between items-center">
                <h3 class="text-lg font-bold text-slate-700">Kemaskini Maklumat Surat</h3>
                <button type="button" class="btnTutupModal text-slate-400 hover:text-red-500 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
            </div>
            <form id="formMemo" class="p-6 space-y-4">
                <input type="hidden" id="memoId">
                <div class="grid grid-cols-2 gap-4">
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">No. Rujukan</label>
                        <input type="text" id="memoNoRujukan" required class="w-full px-3 py-2 border border-slate-300 rounded uppercase-input text-sm font-bold">
                    </div>
                    <div class="col-span-2">
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Perkara / Tajuk Surat</label>
                        <input type="text" id="memoTajuk" required class="w-full px-3 py-2 border border-slate-300 rounded uppercase-input text-sm">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Tarikh Terima</label>
                        <input type="date" id="memoTarikhTerima" required class="w-full px-3 py-2 border border-slate-300 rounded text-sm">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-slate-500 uppercase mb-1">Masa Rekod</label>
                        <input type="time" id="memoMasaRekod" required class="w-full px-3 py-2 border border-slate-300 rounded text-sm bg-slate-50">
                    </div>
                </div>
                <div class="pt-4 flex justify-end space-x-3 border-t border-slate-100 mt-2">
                    <button type="button" class="btnTutupModal px-4 py-2 bg-slate-100 text-slate-600 font-bold rounded text-sm hover:bg-slate-200 transition-colors">Batal</button>
                    <button type="submit" id="btnSimpanMemo" class="px-6 py-2 bg-indigo-600 text-white font-bold rounded text-sm hover:bg-indigo-700 flex items-center shadow-md">Simpan Perubahan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Pautan Fail JS Luaran -->
    <script src="app.js"></script>
    <script src="admin.js"></script>

</body>
</html>